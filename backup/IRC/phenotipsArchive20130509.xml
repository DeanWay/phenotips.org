<?xml version='1.0' encoding='UTF-8'?>
<xwikidoc version="1.1">
  <web>IRC</web>
  <name>phenotipsArchive20130509</name>
  <language />
  <defaultLanguage />
  <translation>0</translation>
  <creator>XWiki.sdumitriu</creator>
  <creationDate>1368073601000</creationDate>
  <parent>IRC.WebHome</parent>
  <author>XWiki.sdumitriu</author>
  <contentAuthor>XWiki.sdumitriu</contentAuthor>
  <date>1368155246000</date>
  <contentUpdateDate>1368155246000</contentUpdateDate>
  <version>1.227</version>
  <title>IRC Archive for channel #phenotips on 09 May 2013</title>
  <comment>Logging from IRC</comment>
  <minorEdit>true</minorEdit>
  <syntaxId>plain/1.0</syntaxId>
  <hidden>false</hidden>
  <content>&lt;khodeir> has quit
00:32 &lt;khodeir> has joined #phenotips
00:47 &lt;khodeir> has quit
01:04 &lt;khodeir> has joined #phenotips
01:42 &lt;khodeir> has quit
01:46 &lt;khodeir> has joined #phenotips
02:00 &lt;khodeir> has quit
02:02 &lt;khodeir> has joined #phenotips
02:11 &lt;sdumitriu> Hey khodeir
02:12 &lt;khodeir> Hello Sergio
02:12 &lt;sdumitriu> Can't sleep?
02:12 &lt;khodeir> Oh not at all haha major jet lag
02:13 &lt;khodeir> Actually I've been trying to get phenotypes and pedigree running
02:14 &lt;sdumitriu> Any problems?
02:14 &lt;khodeir&gt; I've managed to run standalone phenotips by following the build instructions on github but i cannot find the pedigree editor
02:14 &lt;sdumitriu> OK, here's how you activate it
02:14 &lt;sdumitriu> http://localhost:8080/bin/edit/PhenoTips/PatientSheetCode
02:15 &lt;sdumitriu> Search for:
02:15 &lt;sdumitriu> #*
02:16 &lt;sdumitriu> There should be one right before this line:
02:16 &lt;sdumitriu> #set ($pedigreeObj = $doc.getObject('PhenoTips.PedigreeClass'))
02:16 &lt;sdumitriu> Remove the #* line, and search for the following *# line and remove that one as well
02:16 &lt;sdumitriu> Save
02:17 &lt;sdumitriu> Now you should see a "Draw pedigree" button when editing a patient, in the "Family history" section
02:17 &lt;khodeir> Oh okay. Does it matter what user I'm logged in as?
02:18 &lt;sdumitriu> The initial account is:
02:18 &lt;sdumitriu> username: Admin
02:18 &lt;sdumitriu> password: admin
02:18 &lt;sdumitriu> (case sensitive)
02:18 &lt;sdumitriu> But I think any registered account should be able to access that
02:22 &lt;khodeir> Oh okay it's working
02:22 &lt;khodeir> Thank! I should have asked sooner
02:22 &lt;khodeir> Thanks*
02:22 &lt;sdumitriu> You're welcome
04:00 &lt;kushalk124> has joined #phenotips
04:00 &lt;khodeir_> has joined #phenotips
04:01 &lt;khodeir> has quit
04:01 &lt;khodeir_> is now known as &lt;khodeir>
04:04 &lt;khodeir_> has joined #phenotips
04:06 &lt;khodeir> has quit
04:06 &lt;khodeir_> is now known as &lt;khodeir>
04:46 &lt;khodeir> has quit
04:48 &lt;khodeir> has joined #phenotips
05:18 &lt;khodeir_> has joined #phenotips
05:18 &lt;khodeir> has quit
05:18 &lt;khodeir_> is now known as &lt;khodeir>
05:40 &lt;khodeir_> has joined #phenotips
05:42 &lt;khodeir> has quit
05:42 &lt;khodeir_> is now known as &lt;khodeir>
06:02 &lt;kushalk124> has quit
06:22 &lt;khodeir> has quit
06:22 &lt;khodeir> has joined #phenotips
06:27 &lt;khodeir> has quit
07:08 &lt;kushalk124> has joined #phenotips
08:00 &lt;kushalk124> is now known as &lt;kushalkhandelwal>
09:13 &lt;kushalkhandelwal> has quit
09:21 &lt;kushalkhandelwal> has joined #phenotips
11:38 &lt;ravigarg27> has joined #phenotips
12:15 &lt;ravigarg27> has quit
12:21 &lt;kushalkhandelwal> sdumitriu: Hey
12:21 &lt;sdumitriu> Hey
12:21 &lt;kushalkhandelwal> How are you ?
12:21 &lt;kushalkhandelwal> What you doing ?
12:21 &lt;sdumitriu> Lunch
12:21 &lt;kushalkhandelwal> Oh
12:22 &lt;kushalkhandelwal> Lunch Time
12:22 &lt;kushalkhandelwal> Carry on :)
12:53 &lt;sdumitriu> So, how's it going?
12:53 &lt;sdumitriu> Still 2 exams?
13:05 &lt;kushalkhandelwal> Exams n exams
13:05 &lt;kushalkhandelwal> 1 more exam
13:05 &lt;kushalkhandelwal> Had one today
13:06 &lt;kushalkhandelwal> Rest of it going good
13:08 &lt;sdumitriu> Going to the lab
13:09 &lt;kushalkhandelwal> Ok
13:12 &lt;gustavojordan> has joined #phenotips
13:31 &lt;sdumitriu1> has joined #phenotips
13:53 &lt;khodeir> has joined #phenotips
13:55 &lt;khodeir> has quit
14:00 &lt;kushalkhandelwal> has quit
14:03 &lt;khodeir> has joined #phenotips
14:09 &lt;sdumitriu1> has quit
14:11 &lt;sdumitriu1> has joined #phenotips
14:15 &lt;khodeir> has quit
14:33 &lt;kushalkhandelwal> is now known as &lt;Guest62770>
14:43 &lt;khodeir> has joined #phenotips
14:47 &lt;Guest62770> is now known as &lt;kushalk124>
14:49 &lt;kushalk124> has joined #phenotips
14:55 &lt;khodeir> has quit
15:07 &lt;kushalk124> has quit
15:21 &lt;kushalk124_> has joined #phenotips
15:31 &lt;BogdanVancea> has quit
16:04 &lt;gustavojordan> has quit
16:10 &lt;kushalk124_> has quit
17:03 &lt;user12345> has joined #phenotips
17:04 &lt;user12345> Would anyone be able to help me debug Phenotips using eclipse? I emailed a couple days ago and was told to modify the START_OPTS variable or use a start_debug.sh script to debug in eclipse. Unfortunately, I don't even know what the main type for the project at this point.
17:05 &lt;sdumitriu1> Hi
17:05 &lt;sdumitriu1> Well, there is no main type
17:05 &lt;sdumitriu1> This is a web application, meaning that it runs as a collection of servlets inside a servelt container
17:06 &lt;sdumitriu1> What exactly are you trying to debug?
17:06 &lt;user12345> I'd like to  see how phenotips is accessing the HPO and how the pages are rendered, mostly
17:07 &lt;user12345> Would like to look at the flow of control as user inputs data as well
17:07 &lt;sdumitriu1> OK
17:09 &lt;sdumitriu1> It's hard to explain, since the flow is complex
17:09 &lt;sdumitriu1> Let's start at the end
17:09 &lt;sdumitriu1> The HPO ontology is indexed using Lucene in a Solr server
17:10 &lt;sdumitriu1> You can find that index in solrconfig/hpo/data/index
17:10 &lt;sdumitriu1> But it's a binary index, used by Solr internally
17:11 &lt;sdumitriu1> Solr is also a web application, so it's not easy to get in its internals
17:11 &lt;sdumitriu1> But it exposes HPO terms through HTTP requests
17:12 &lt;user12345> so none of the HPO is stored locally.
17:12 &lt;sdumitriu1> For example: http://localhost:8080/solr/hpo/select?spellcheck=true&amp;q=ADHD
17:12 &lt;sdumitriu1> It is stored locally, but in a different application
17:13 &lt;sdumitriu1> Back in PhenoTips, this Solr server is accessed through a Java library called SolrJ
17:14 &lt;sdumitriu1> It allows calls to a Solr server from Java, using nicer APIs than raw HTTP requests
17:15 &lt;sdumitriu1> And we use this library from a ScriptService: https://github.com/compbio-UofT/phenotips/blob/master/components/solr-access-service/src/main/java/edu/toronto/cs/phenotips/solr/AbstractSolrScriptService.java
17:15 &lt;sdumitriu1> (now we get for the first time in PhenoTips' own code)
17:16 &lt;sdumitriu1> So we can search for HPO terms matching a query using methods from this class
17:16 &lt;sdumitriu1> This is an Abstract class, with two classes extending it:
17:16 &lt;sdumitriu1> https://github.com/compbio-UofT/phenotips/blob/master/components/solr-access-service/src/main/java/edu/toronto/cs/phenotips/solr/HPOScriptService.java for HPO
17:16 &lt;sdumitriu1> And https://github.com/compbio-UofT/phenotips/blob/master/components/solr-access-service/src/main/java/edu/toronto/cs/phenotips/solr/OmimScriptService.java for OMIM
17:17 &lt;sdumitriu1> A "ScriptService" is a special kind of class, it's a component that can be accessed from code written in documents
17:18 &lt;sdumitriu1> PhenoTips is built on top of XWiki, which is among other things a wiki engine
17:18 &lt;sdumitriu1> So it contains documents
17:18 &lt;user12345> indeed
17:18 &lt;sdumitriu1> Some documents can contain special code blocks, such as https://github.com/compbio-UofT/phenotips/blob/master/resources/ui/src/main/resources/PhenoTips/SolrService.xml#L67
17:19 &lt;sdumitriu1> You see on the highlighted line that it calls a method from $services.hpo
17:19 &lt;user12345> yes
17:19 &lt;sdumitriu1> That's the HPOScriptService class
17:20 &lt;sdumitriu1> Now, this SolrService document is called via AJAX requests whenever you type something in the quick phenotype search field
17:22 &lt;sdumitriu1> Other places also use this HPOScriptService, both from wiki documents and directly from Java
17:23 &lt;sdumitriu1> So, to recapitulate, displaying an HPO term goes through the HPOScriptService, which uses SolrJ to communicate with the Solr server which stores the ontology in a Lucene index
17:24 &lt;sdumitriu1> The page rendering process is even more complex...
17:26 &lt;sdumitriu1> The canonical form of the URL would be "/phenotips/bin/view/data/P0000001", where:
17:27 &lt;sdumitriu1> - /phenotips is the application name, but in the default distribution the application is configured to be the "default" application which doesn't have its own name present in the URL
17:28 &lt;sdumitriu1> - /bin matches a servlet name, configured in WEB-INF/web.xml; this actually is the Struts servlet, where Struts is a framework for writing java web applications in a simpler way
17:28 &lt;sdumitriu1> - /view is the name of the Struts action being invoked
17:29 &lt;sdumitriu1> Struts actions are configured in struts-config.xml
17:29 &lt;sdumitriu1> And this one is served by https://github.com/xwiki/xwiki-platform/blob/master/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/ViewAction.java
17:30 &lt;sdumitriu1> - /data is the space name: XWiki groups its documents in spaces
17:30 &lt;sdumitriu1> - /P0000001 is the document name
17:34 &lt;user12345> There should be a document named "P0000001 " in my workspace?
17:34 &lt;sdumitriu1> No
17:34 &lt;sdumitriu1> That would be the first patient you create
17:34 &lt;user12345> Oh, I see
17:34 &lt;sdumitriu1> Sorry, in a meeting right now
17:42 &lt;sdumitriu1> Back
17:44 &lt;sdumitriu1> So, the method that gets called first is "action", which returns a boolean
17:44 &lt;sdumitriu1> If it returns false, it's considered that the request has already been answered
17:44 &lt;sdumitriu1> If it returns true, then "render" is called, and this one returns a String, which is the name of a velocity template to render
17:45 &lt;sdumitriu1> As you can see, ViewAction#render  returns "view", which corresponds to templates/view.vm
17:46 &lt;sdumitriu1> (actually a template can be overridden in several places, and this one actually is replaced by an attachment of the PhenoTips.Skin document)
17:46 &lt;sdumitriu1> Next, the Velocity engine is used to render view.vm
17:46 &lt;sdumitriu1> (here it is: https://github.com/xwiki/xwiki-platform/blob/master/xwiki-platform-core/xwiki-platform-web/src/main/webapp/templates/view.vm )
17:47 &lt;user12345> which of the four view.vm files should I be concerned with?
17:47 &lt;sdumitriu1> #template means that another template is included in place
17:48 &lt;sdumitriu1> Normally, contentview.vm is the one that actually renders the content of the document
17:48 &lt;sdumitriu1> https://github.com/xwiki/xwiki-platform/blob/master/xwiki-platform-core/xwiki-platform-web/src/main/webapp/templates/contentview.vm
17:48 &lt;sdumitriu1> And the important call is $tdoc.getRenderedContent($outputSyntax)
17:48 &lt;sdumitriu1> Hm...
17:49 &lt;sdumitriu1> 3 of them are probably nested in /target/ subdirectories, those aren't important, they're just the result of the build process
17:49 &lt;sdumitriu1> Or no, all of them are
17:49 &lt;user12345> hmm
17:49 &lt;user12345> yeah
17:49 &lt;user12345> all of them are
17:49 &lt;sdumitriu1> Since this comes from the XWiki platform
17:50 &lt;user12345> top level it's phenotips-distribution and phenotips-parent
17:50 &lt;sdumitriu1> (If you want to debug stuff, you're going to need the code for XWiki as well)
17:50 &lt;user12345> yeah, I mean, ideally, I'd like to make small changes and be able to test them without having to make a standalone each time
17:51 &lt;sdumitriu1> $tdoc.getRenderedContent($outputSyntax) ends up in https://github.com/xwiki/xwiki-platform/blob/master/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/doc/XWikiDocument.java#L903
17:51 &lt;sdumitriu1> Which goes to https://github.com/xwiki/xwiki-platform/blob/master/xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/doc/XWikiDocument.java#L7890
17:52 &lt;sdumitriu1> And which invokes the XWiki rendering engine, which is another big beast...
17:52 &lt;sdumitriu1> But, most of the time you're not going to need to change Java code
17:53 &lt;sdumitriu1> What you need to do is edit the code inside the PhenoTips space
17:53 &lt;sdumitriu1> Unfortunately, we've hidden the editing UI
17:53 &lt;user12345> ahh
17:53 &lt;sdumitriu1> So it's hard to actually find how to edit documents...
17:54 &lt;user12345> ahh, I see
17:54 &lt;sdumitriu1> http://localhost:8080/bin/admin/PhenoTips/WebPreferences?editor=spaceadmin&amp;section=Presentation&amp;space=PhenoTips
17:54 &lt;sdumitriu1> Write in the Skin field: XWiki.DefaultSkin
17:54 &lt;sdumitriu1> Then save
17:55 &lt;user12345> so I'd be modifying a running version of phenotips rather than actually touching the source at all?
17:55 &lt;sdumitriu1> You should see the code documents in http://localhost:8080/bin/PhenoTips/WebHome
17:55 &lt;sdumitriu1> Right
17:55 &lt;sdumitriu1> Whatever you change won't be saved in the sources
17:56 &lt;sdumitriu1> To do that, once you edit a document you have to export it
17:56 &lt;sdumitriu1> You can either export the whole wiki from the administration
17:56 &lt;user12345> so it would be like editing a wiki page via a gui and then given it back to the project
17:56 &lt;user12345> would I have to modify the POM in that case?
17:56 &lt;sdumitriu1> Or one document at the time using the Export -> Export as XAR entry from the menu that should become visible once you activate the default skin
17:57 &lt;sdumitriu1> A .xar file is actually a .zip file with a different extension
17:57 &lt;sdumitriu1> You have to open it and copy the XML file over the original source
17:57 &lt;sdumitriu1> The POM, no, that describes the project
17:58 &lt;sdumitriu1> You change the .xml files, from https://github.com/compbio-UofT/phenotips/tree/master/resources/ui/src/main/resources/PhenoTips and other places where the sources are
18:04 &lt;user12345> Ok, thanks a lot
18:05 &lt;user12345> I'll save this conversation and I think I should be able to make a lot more progress now. Have a good night!
18:07 &lt;sdumitriu1> Thanks, you too
18:07 &lt;user12345> has left #phenotips
18:08 &lt;sdumitriu1> PS: You can find the log here: http://phenotips.org/IRC/phenotipsArchive20130509
19:42 &lt;sdumitriu1> has quit
19:44 &lt;khodeir> has joined #phenotips
20:14 &lt;khodeir> has quit
20:23 &lt;khodeir> has joined #phenotips
20:49 &lt;khodeir> has left #phenotips
21:27 &lt;kushalkhandelwal> has joined #phenotips
21:27 &lt;kushalkhandelwal> sdumitriu: Hey
21:27 &lt;sdumitriu> Hey
21:27 &lt;sdumitriu> You should read today's log from #phenotips
21:28 &lt;kushalkhandelwal> Hm Ok :)
21:28 &lt;sdumitriu> Had an interesting code discussion
21:28 &lt;kushalkhandelwal> Would do that
21:28 &lt;kushalkhandelwal> Ahh
21:28 &lt;kushalkhandelwal> Why I was not online at that time
21:29 &lt;sdumitriu> Probably sleeping
21:29 &lt;kushalkhandelwal> Hmm
21:29 &lt;kushalkhandelwal> Slept early
21:34 &lt;kushalkhandelwal> Ah
21:34 &lt;kushalkhandelwal> Interesting conversation
21:34 &lt;kushalkhandelwal> I think we should make a wiki on Github
21:34 &lt;kushalkhandelwal> and put such code related details there
21:34 &lt;kushalkhandelwal> which can be refined continuously
21:34 &lt;kushalkhandelwal> Documentation
21:35 &lt;kushalkhandelwal> :D
21:35 &lt;kushalkhandelwal> I didn't new about exporting to XAR file
22:53 &lt;kushalkhandelwal> has quit
23:07 &lt;ravigarg27> has quit</content>
  <object>
    <name>IRC.phenotipsArchive20130509</name>
    <number>0</number>
    <className>IRC.IRCBotArchiveClass</className>
    <guid>971cf29b-66c1-4231-8fe6-b40a76f9a8f9</guid>
    <class>
      <name>IRC.IRCBotArchiveClass</name>
      <customClass />
      <customMapping />
      <defaultViewSheet />
      <defaultEditSheet />
      <defaultWeb />
      <nameField />
      <validationScript />
      <channel>
        <customDisplay />
        <disabled>0</disabled>
        <name>channel</name>
        <number>1</number>
        <picker>0</picker>
        <prettyName>Channel</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage />
        <validationRegExp />
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </channel>
    </class>
    <property>
      <channel>phenotips</channel>
    </property>
  </object>
</xwikidoc>