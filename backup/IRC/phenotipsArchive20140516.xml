<?xml version='1.0' encoding='UTF-8'?>
<xwikidoc version="1.1">
  <web>IRC</web>
  <name>phenotipsArchive20140516</name>
  <language />
  <defaultLanguage />
  <translation>0</translation>
  <creator>XWiki.sdumitriu</creator>
  <creationDate>1400227115000</creationDate>
  <parent>IRC.WebHome</parent>
  <author>XWiki.sdumitriu</author>
  <contentAuthor>XWiki.sdumitriu</contentAuthor>
  <date>1400281413000</date>
  <contentUpdateDate>1400281413000</contentUpdateDate>
  <version>1.102</version>
  <title>IRC Archive for channel #phenotips on 16 May 2014</title>
  <comment>Logging from IRC</comment>
  <minorEdit>true</minorEdit>
  <syntaxId>plain/1.0</syntaxId>
  <hidden>false</hidden>
  <content>&lt;vijay13> has quit
09:49 &lt;akats> has joined #phenotips
11:54 &lt;akats> sdumitriu: For the charts, we don't want all the charts to be in weeks. Just the 0-13 weeks chart, right?
11:55 &lt;sdumitriu1> Yes
11:57 &lt;akats> In that case, correct me if I'm wrong, I don't have to modify much, just stick the label "weeks" instead of "months" in the chart configuration. Plus load the right data.
11:57 &lt;akats> Wait, I'm wrong
11:58 &lt;akats> Because the position of the "dot/blob" on the chart is dependent on the current age which is in months
12:08 &lt;sdumitriu1> There are many things which need changing
12:15 &lt;akats> By the way, I've tested this on 2 different builds and with opening just the chart vs opening it as part of a patient record and I get too many calls to https://github.com/phenotips/phenotips/blob/d7babd65475f21a6bc229d701db99a975755d812/components/patient-measurements/api/src/main/java/org/phenotips/measurements/MeasurementsScriptService.java#L88
12:15 &lt;akats> Here's the log https://gist.github.com/anonymous/af064a3033eb7a188243
12:29 &lt;sdumitriu1> That's normal
12:29 &lt;sdumitriu1> It's part of drawing the chart
12:30 &lt;vijay13> has quit
12:33 &lt;akats> I see.
12:37 &lt;vijay13_> has quit
13:55 &lt;vijay13_> has quit
15:39 &lt;vijay13> has quit
16:38 &lt;mcupak> has quit
17:14 &lt;akats> Should I change the basic time interval to days rather than weeks, so that there is a absolutely no chance that it will ever need to be changed again?
17:14 &lt;akats> Hours is too small of a time interval even for premature babies as far as I understand
17:25 &lt;sdumitriu1> akats: I think the whole paradigm needs to be changed
17:25 &lt;sdumitriu1> Days is better, indeed
17:27 &lt;akats> What do you mean by the whole paradigm needs to change?
17:28 &lt;sdumitriu1> Right now we just have a list of values at month intervals (the LMS lists)
17:28 &lt;sdumitriu1> But we need a sparse interval of ages in days
17:29 &lt;sdumitriu1> If we just use days as the unit for those arrays, we'd waste a lot of space
17:30 &lt;sdumitriu1> Plus, if we want to add support for preterm births, then we need to have some real interpolation algorithm to go from (birth age + age) -> expected measurement
17:34 &lt;akats> Are you trying to say that this needs a major rewrite?
17:35 &lt;sdumitriu1> Yes
17:35 &lt;akats> Ok. Then in this case I'll take care of smaller issue until I see you
17:35 &lt;akats> Are you going to come in tomorrow?
17:36 &lt;sdumitriu1> Saturday?
17:36 &lt;akats> Yup
17:36 &lt;sdumitriu1> Don't think so, but I'll be online
17:36 &lt;sdumitriu1> Monday is a holiday too
17:36 &lt;akats> Ok. I don't think I'll be in Monday
17:37 &lt;sdumitriu1> You can read through the available classes in commons-math
17:38 &lt;akats> Why?
17:38 &lt;sdumitriu1> See if there's anything that would help with: sparse array (worst case, use a sparse matrix with 1 row), interpolation (preferably not linear)
17:38 &lt;akats> Oh
17:39 &lt;akats> Maybe it would be easier to base the whole mechanism on absolute age. As in since conception.
17:39 &lt;akats> That way we don't have to treat premature babies any different
17:40 &lt;sdumitriu1> It's not that simple
17:41 &lt;sdumitriu1> The adjustment is not as simple as that
17:41 &lt;sdumitriu1> Babies grow differently inside and outside
17:42 &lt;akats> How much data will there be for premature babies?
17:43 &lt;akats> Or phrased differently how much interpolation do we need to do?
17:44 &lt;sdumitriu1> I don't know yet
17:44 &lt;sdumitriu1> For the moment, let's just implement support for term babies
17:46 &lt;akats> Are you sure? If you're saying this will take a rewrite, maybe it is better to wait a little bit until we know more details about the problem.
17:46 &lt;sdumitriu1> OK
17:48 &lt;sdumitriu1> Read this: http://www.rcpch.ac.uk/system/files/protected/page/BOYS%20NICM%20%284th%20Jan%202013%29.pdf
17:53 &lt;akats> I'm assuming preterm babies also grow different than term babies for the rest of the growth period/life
17:53 &lt;sdumitriu1> No, after a few months they stabilize
17:54 &lt;sdumitriu1> It's just the first few months that are different
17:54 &lt;sdumitriu1> Slowly catching up
17:55 &lt;akats> That's crazy. I would've never guessed that they could.
17:58 &lt;akats> Are we going to interpolate that or are we just going to treat them equally once post term?
17:58 &lt;sdumitriu1> Not sure yet
17:59 &lt;akats> ok
18:06 &lt;sdumitriu1> http://www.rcpch.ac.uk/sites/default/files/asset_library/Research/Growth%20Charts/Education%20Materials%2001092010/FS5_Pre-term%20InfantsV.pdf
18:09 &lt;sdumitriu1> According to this, "After birth an individual baby’s growth is notexpected to follow the centile lines shown in the “preterm” section because it shows only birth measurements. Most preterm babies will show slow initial weight gain or weight loss. This means they will appear to fall on the chart."
18:18 &lt;sdumitriu1> Hm
18:18 &lt;sdumitriu1> I think we're overcomplicating things
18:18 &lt;sdumitriu1> Doctors _expect_ this
18:18 &lt;sdumitriu1> We should just display standard measurements
18:19 &lt;sdumitriu1> It is up to the doctors to make sense of the data, we're just supposed to plot the measurements as they are
18:19 &lt;sdumitriu1> No interpolation
18:19 &lt;sdumitriu1> akats: Agreed?
18:23 &lt;akats> Yeah
18:23 &lt;akats> I think you're right
18:24 &lt;akats> So our task is to plot the dots from official data and plot the current position of the patient
18:24 &lt;sdumitriu1> Yes
18:25 &lt;sdumitriu1> Still, we should look into sparse arrays
18:25 &lt;sdumitriu1> And interpolation on them
18:25 &lt;sdumitriu1> No extra fancy adjustments
18:25 &lt;akats> In this case as far as I understand there are two options for underlying mechanism plotting the charts.
18:26 &lt;akats> absolute age or negative age for preterm babies
18:27 &lt;akats> Why sparse arrays?
18:28 &lt;akats> That one I don't understand. Why not just a map?
18:29 &lt;akats> You said that right now you do no interpolation. Just straight lines. Correct?
18:29 &lt;sdumitriu1> For performance?
18:29 &lt;sdumitriu1> Yes
18:29 &lt;sdumitriu1> But that's linear interpolation
18:32 &lt;sdumitriu1> We'll see what data structure is best
18:33 &lt;akats> Right now linear interpolation looks fine. Further interpolation does not provide any additional data as far as I understand.
18:34 &lt;akats> By the way I really don't like how that one module is called 1700 times. Why is that necessary?
18:36 &lt;sdumitriu1> To draw the percentile guidelines
18:36 &lt;sdumitriu1> The pink lines here: https://playground.phenotips.org/bin/get/PhenoTips/ChartService?n=height&amp;s=F&amp;a=0&amp;height=50.5&amp;a=0&amp;height=51.0&amp;a=0&amp;height=53.0&amp;standalone=1
18:37 &lt;sdumitriu1> Also the gery dotted lines
18:37 &lt;sdumitriu1> grey
18:37 &lt;sdumitriu1> In theory we could cache the base chart
18:37 &lt;sdumitriu1> That would speed up things a bit
18:39 &lt;akats> But in the function JavaDoc it says "Get the handler for a specific kind of measurements."
18:39 &lt;akats> The code also doesn't seem to return data
18:39 &lt;sdumitriu1> brb
18:39 &lt;akats> ok
18:40 &lt;sdumitriu1> Actually, later, it might be a while
18:41 &lt;akats> That's ok too. I might be gone too tough.
18:41 &lt;akats> I'll work on the smaller issues anyways
18:50 &lt;vijay13> has quit
19:03 &lt;akats> has quit</content>
  <object>
    <name>IRC.phenotipsArchive20140516</name>
    <number>0</number>
    <className>IRC.IRCBotArchiveClass</className>
    <guid>aeeeefa4-c597-4a01-abf0-5c8085c1ff0b</guid>
    <class>
      <name>IRC.IRCBotArchiveClass</name>
      <customClass />
      <customMapping />
      <defaultViewSheet />
      <defaultEditSheet />
      <defaultWeb />
      <nameField />
      <validationScript />
      <channel>
        <customDisplay />
        <disabled>0</disabled>
        <name>channel</name>
        <number>1</number>
        <picker>0</picker>
        <prettyName>Channel</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <validationMessage />
        <validationRegExp />
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </channel>
    </class>
    <property>
      <channel>phenotips</channel>
    </property>
  </object>
</xwikidoc>